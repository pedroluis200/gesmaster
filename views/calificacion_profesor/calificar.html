{{extend 'layout_admin.html'}}


<div class="row">
    <div class="col-12">
        <a href="{{=URL('select_maestria')}}" class="btn btn-primary mb-2 mr-1">
            <i class="fa fa-trophy"></i>
            Maestrías
        </a>

        <a href="{{=URL('select_edicion', args=actividad_edicion.id_edicion.id_maestria)}}"
            class="btn btn-info mb-2 mr-1">
            <i class="fa fa-table mr-1"></i>
            Ediciones
        </a>

        <a href="{{=URL('select_actividad', args=actividad_edicion.id_edicion)}}" class="btn btn-success mb-2">
            <i class="fa fa-list-alt mr-1"></i>
            Actividades
        </a>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-body">
                <h4 class="card-title">Calificar</h4>
                <h5 class="mb-1">Maestría: {{=actividad_edicion.id_edicion.id_maestria.nombre}}</h5>
                <h5 class="mb-1">Edición # {{=actividad_edicion.id_edicion.numero}}</h5>
                <h5 class="mb-3">Actividad: {{=actividad_edicion.id_actividad.nombre}}</h5>
                <div class="table-responsive">
                    <table class="table table-striped table-bordered">
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>CI</th>
                                <th>Nota</th>
                                <th>Tipo</th>
                                <th></th>
                            </tr>
                        </thead>
                        <tbody>
                            {{for row in calificaciones:}}
                            {{calificacion = get_calificacion(db, actividad_edicion.id, row.id)}}
                            <tr>
                                <td>{{=' '.join([row.nombre, row.apellido1, row.apellido2])}}</td>
                                <td>{{=row.ci}}</td>
                                <td>{{=calificacion.nota if calificacion else ''}}</td>
                                <td>
                                    {{if calificacion:}}
                                    {{if calificacion.tipo == 'Suficiencia':}}
                                    <span class="badge badge-success">Suficiencia</span>
                                    {{elif calificacion.tipo == 'Convalidado':}}
                                    <span class="badge badge-info">Convalidado</span>
                                    {{else:}}
                                    <span class="badge badge-primary">Examen</span>
                                    {{pass}}
                                    {{else:}}
                                    <span class="badge badge-secondary">No calificado</span>
                                    {{pass}}
                                </td>
                                <td>
                                    {{if calificacion:}}
                                    
                                    {{=A(I(_class="fas fa-pencil-square-o mr-2"), 'Editar',
                                    _class='btn btn-success btn-rounded text-white mb-2',
                                    _target='_blank',
                                    _href=URL("send_calificacion",
                                    vars={'id_actividad_edicion': actividad_edicion.id, 'id_estudiante': row.id, 'reload_div': 'load'}),
                                    cid="content-calificar",
                                    data={'toggle':'modal', 'target':'#calificar-modal'})}}

                                    <a href="#" onclick="delete_elem(`{{=URL('eliminar_calificacion', args=calificacion.id)}}`)"
                                        class="btn btn-danger btn-rounded text-white mb-2">
                                        <i class="fas fa-trash"></i>
                                    </a>
                                    {{else:}}

                                    {{=A(I(_class="fas fa-pencil-square-o mr-2"), 'Calificar',
                                    _class='btn btn-primary btn-rounded text-white mb-2',
                                    _target='_blank',
                                    _href=URL("send_calificacion",
                                    vars={'id_actividad_edicion': actividad_edicion.id, 'id_estudiante': row.id, 'reload_div': 'load'}),
                                    cid="content-calificar",
                                    data={'toggle':'modal', 'target':'#calificar-modal'})}}
                                    
                                    {{pass}}
                                </td>
                            </tr>
                            {{pass}}
                        </tbody>
                        <tfoot>
                            <tr>
                                <th>Nombre</th>
                                <th>CI</th>
                                <th>Nota</th>
                                <th>Tipo</th>
                                <th></th>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>


{{block page_js}}
<div class="modal fade" id="calificar-modal" tabindex="-1" role="dialog" aria-labelledby="staticModalLabel"
    data-backdrop="static">
    <div class="modal-dialog modal-sm" role="document" id="content-calificar">
    </div>
</div>

{{end}}